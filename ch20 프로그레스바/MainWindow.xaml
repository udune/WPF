<!-- 
    ch20 프로그레스바 - WPF ProgressBar 컨트롤의 다양한 기능을 보여주는 예제 파일
    ProgressBar는 작업의 진행 상태를 시각적으로 표시하는 컨트롤입니다.
    파일 다운로드, 설치, 데이터 처리 등 시간이 걸리는 작업의 진행률을 사용자에게 알려줍니다.
-->
<Window x:Class="ch20_프로그레스바.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ch20_프로그레스바"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">
    <StackPanel>
        <!-- 
            ProgressBar: 작업 진행 상태를 표시하는 컨트롤
            진행률을 시각적으로 표현
        -->
        <ProgressBar Height="20" Value="50"
                     Minimum="0" Maximum="100"
                     IsIndeterminate="True"></ProgressBar>
        <!-- 
            ProgressBar 기본 개념:
            - 작업의 진행 상태를 시각적으로 표시
            - 두 가지 모드: Determinate(확정적), Indeterminate(불확정적)
            - 수평(기본) 또는 수직 방향 지원
            - Minimum ~ Maximum 범위에서 Value로 진행률 표시
            
            ProgressBar의 주요 속성:
            
            Height="20":
            - ProgressBar의 높이
            - 일반적으로 20~30픽셀 사용
            
            Value="50":
            - 현재 진행 값
            - Minimum과 Maximum 사이의 값
            - 50 = 50% 진행 (Minimum=0, Maximum=100일 때)
            
            Minimum="0":
            - 최소값 (진행 시작 지점)
            - 기본값: 0
            - 음수 값도 가능
            
            Maximum="100":
            - 최대값 (진행 완료 지점)
            - 기본값: 100
            - Value가 Maximum에 도달하면 100% 완료
            
            IsIndeterminate="True":
            - 불확정적 모드 (진행률을 알 수 없을 때)
            - True: 애니메이션 표시 (계속 움직임)
            - False: 정확한 진행률 표시 (기본값)
            
            진행률 계산:
            진행률(%) = (Value - Minimum) / (Maximum - Minimum) × 100
            
            예: Value=50, Minimum=0, Maximum=100
            진행률 = (50 - 0) / (100 - 0) × 100 = 50%
            
            Determinate vs Indeterminate 모드:
            
            Determinate (확정적):
            - IsIndeterminate="False" (기본값)
            - 정확한 진행률을 알 때 사용
            - Value로 진행 상태 표시
            - 예: 파일 다운로드 (50MB 중 25MB 완료)
            
            시각적 표현:
            ┌──────────────────────┐
            │████████░░░░░░░░░░░░░░│ 50%
            └──────────────────────┘
            
            Indeterminate (불확정적):
            - IsIndeterminate="True"
            - 진행률을 알 수 없을 때 사용
            - 계속 움직이는 애니메이션
            - Value 값 무시됨
            - 예: 서버 연결 대기, 검색 중
            
            시각적 표현:
            ┌──────────────────────┐
            │░░░░████████░░░░░░░░░░│ ← 애니메이션
            └──────────────────────┘
            
            주의: IsIndeterminate="True"이면 Value="50"은 무시됩니다.
            위 예제에서는 불확정 애니메이션이 표시됩니다.
        -->

        <Separator></Separator>
        <!-- 
            Separator: 구분선
            UI 요소들을 시각적으로 구분
        -->
        
        <!-- 버튼 클릭으로 ProgressBar 값 증가 -->
        <Button Click="Button_Click">버튼</Button>
        <!-- 
            Button:
            - 클릭 이벤트로 ProgressBar의 Value 증가
            - Button_Click 이벤트 핸들러 (코드 비하인드)
            - 클릭할 때마다 pb.Value += 10
        -->
        
        <!-- ProgressBar와 퍼센트 표시가 겹쳐진 구조 -->
        <Grid>
            <!-- 
                Grid:
                - ProgressBar와 TextBlock을 겹쳐서 배치
                - TextBlock이 ProgressBar 위에 표시됨
            -->
            
            <!-- 실제 ProgressBar -->
            <ProgressBar Name="pb" Height="20" Maximum="100"></ProgressBar>
            <!-- 
                ProgressBar 속성:
                
                Name="pb":
                - 코드 비하인드에서 접근하기 위한 이름
                - Button_Click에서 pb.Value += 10 사용
                
                Height="20":
                - ProgressBar 높이
                
                Maximum="100":
                - 최대값 100
                - Minimum은 기본값 0
                - 0~100 범위 (퍼센트 표시에 적합)
                
                IsIndeterminate 생략:
                - 기본값 False
                - Determinate 모드 (정확한 진행률 표시)
                
                Value 생략:
                - 초기값 0 (0%)
                - 버튼 클릭으로 10씩 증가
            -->
            
            <!-- 진행률을 텍스트로 표시 -->
            <TextBlock HorizontalAlignment="Center" Text="{Binding ElementName=pb, Path=Value, StringFormat= {}{0:0}%}"></TextBlock>
            <!-- 
                TextBlock:
                - ProgressBar 위에 퍼센트 텍스트 표시
                - 중앙 정렬로 ProgressBar 중간에 위치
                
                HorizontalAlignment="Center":
                - 수평 중앙 정렬
                - ProgressBar의 중앙에 텍스트 배치
                
                Text 데이터 바인딩:
                {Binding ElementName=pb, Path=Value, StringFormat= {}{0:0}%}
                
                데이터 바인딩 구성요소:
                
                1. ElementName="pb":
                   - 바인딩 소스 지정
                   - "pb"라는 이름의 ProgressBar에 바인딩
                
                2. Path=Value:
                   - ProgressBar의 Value 속성에 바인딩
                   - pb.Value가 변경되면 자동으로 텍스트 업데이트
                
                3. StringFormat= {}{0:0}%:
                   - 값을 문자열로 포맷팅
                   - {}는 XAML 이스케이프 (중괄호 사용을 위해)
                   - {0:0}: 소수점 없이 정수로 표시
                   - %: 퍼센트 기호 추가
                
                예시:
                - pb.Value = 0  → "0%"
                - pb.Value = 25 → "25%"
                - pb.Value = 50 → "50%"
                - pb.Value = 75 → "75%"
                - pb.Value = 100 → "100%"
                
                StringFormat 포맷 옵션:
                - {0:0}: 정수 (50.5 → 50)
                - {0:0.0}: 소수점 1자리 (50.5 → 50.5)
                - {0:0.00}: 소수점 2자리 (50.5 → 50.50)
                - {0:P}: 퍼센트 (0.5 → 50%)
                - {0:N0}: 천단위 구분 (1234 → 1,234)
                
                자동 업데이트:
                버튼 클릭 → pb.Value 증가 → 바인딩으로 TextBlock 자동 업데이트
                
                시각적 결과:
                ┌──────────────────────┐
                │████████░░░░░░  50%  │ ← TextBlock이 위에 표시
                └──────────────────────┘
            -->
        </Grid>
    </StackPanel>
    
    <!--
        ProgressBar 추가 기능 및 활용:
        
        1. 기본 Determinate ProgressBar:
           <ProgressBar Height="20" 
                        Minimum="0" 
                        Maximum="100" 
                        Value="50"/>
           
           결과: 50% 진행 상태
        
        2. Indeterminate ProgressBar (로딩 중):
           <ProgressBar Height="20" 
                        IsIndeterminate="True"/>
           
           결과: 계속 움직이는 애니메이션
        
        3. 수직 ProgressBar:
           <ProgressBar Width="20" 
                        Height="200" 
                        Orientation="Vertical"
                        Value="50" 
                        Maximum="100"/>
           
           주의: Orientation 속성은 직접 지원하지 않음
           LayoutTransform 사용 필요
        
        4. 색상 변경:
           <ProgressBar Height="20" 
                        Value="50" 
                        Maximum="100"
                        Foreground="Green"
                        Background="LightGray"/>
           
           - Foreground: 진행 바 색상
           - Background: 배경 색상
        
        5. 애니메이션이 있는 진행:
           코드 비하인드에서 DispatcherTimer 사용
        
        6. 부드러운 전환:
           <ProgressBar Height="20" 
                        IsIndeterminate="False">
               <ProgressBar.Triggers>
                   <EventTrigger RoutedEvent="Loaded">
                       <BeginStoryboard>
                           <Storyboard>
                               <DoubleAnimation 
                                   Storyboard.TargetProperty="Value"
                                   From="0" To="100" 
                                   Duration="0:0:5"/>
                           </Storyboard>
                       </BeginStoryboard>
                   </EventTrigger>
               </ProgressBar.Triggers>
           </ProgressBar>
        
        실전 활용 예제:
        
        1. 파일 다운로드:
           <ProgressBar Name="downloadProgress" 
                        Height="20" 
                        Maximum="100"/>
           <TextBlock Text="{Binding ElementName=downloadProgress, 
                                     Path=Value, 
                                     StringFormat=다운로드 중... {0:0}%}"/>
        
        2. 설치 진행:
           <StackPanel>
               <TextBlock Text="프로그램 설치 중..."/>
               <ProgressBar Name="installProgress" 
                           Height="20" 
                           Maximum="100"/>
               <TextBlock Text="{Binding ElementName=installProgress, 
                                        Path=Value, 
                                        StringFormat={}{0:0}% 완료}"/>
           </StackPanel>
        
        3. 로딩 화면:
           <StackPanel HorizontalAlignment="Center" 
                      VerticalAlignment="Center">
               <TextBlock Text="로딩 중..." 
                         HorizontalAlignment="Center" 
                         Margin="0,0,0,10"/>
               <ProgressBar Width="200" 
                           Height="20" 
                           IsIndeterminate="True"/>
           </StackPanel>
        
        4. 다중 단계 진행:
           <StackPanel>
               <TextBlock Text="전체 진행률"/>
               <ProgressBar Name="overallProgress" Height="20" Maximum="100"/>
               
               <TextBlock Text="현재 단계" Margin="0,10,0,0"/>
               <ProgressBar Name="currentStepProgress" Height="20" Maximum="100"/>
           </StackPanel>
        
        5. 색상 단계별 변경:
           <ProgressBar Name="coloredProgress" 
                        Height="20" 
                        Maximum="100">
               <ProgressBar.Style>
                   <Style TargetType="ProgressBar">
                       <Style.Triggers>
                           <Trigger Property="Value" Value="100">
                               <Setter Property="Foreground" Value="Green"/>
                           </Trigger>
                           <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Value}" Value="0">
                               <Setter Property="Foreground" Value="Red"/>
                           </DataTrigger>
                       </Style.Triggers>
                   </Style>
               </ProgressBar.Style>
           </ProgressBar>
        
        6. 원형 진행바 (커스텀):
           <Grid Width="100" Height="100">
               <Ellipse Stroke="LightGray" StrokeThickness="10"/>
               <Path Stroke="Blue" StrokeThickness="10">
               </Path>
               <TextBlock Text="50%" 
                         HorizontalAlignment="Center" 
                         VerticalAlignment="Center"/>
           </Grid>
        
        ProgressBar 이벤트:
        
        1. ValueChanged:
           <ProgressBar ValueChanged="ProgressBar_ValueChanged"/>
           
           코드:
           private void ProgressBar_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
           {
               // Value가 변경될 때 호출
           }
        
        ProgressBar의 장단점:
        
        장점:
        - 진행 상태를 직관적으로 표시
        - 사용자에게 작업 진행 중임을 알림
        - 대기 시간에 대한 불안감 감소
        - Indeterminate 모드로 불확정적 작업 표시
        
        단점:
        - 정확한 진행률 계산 필요
        - 부정확한 진행률은 사용자 경험 저하
        - UI 스레드에서 업데이트 필요
        
        모범 사례:
        
        1. 정확한 진행률:
           - 실제 작업 진행과 일치하도록
           - 예측 가능한 경우에만 Determinate 사용
        
        2. 적절한 모드 선택:
           - 진행률을 알 수 없으면 Indeterminate
           - 정확한 진행률을 알면 Determinate
        
        3. 진행 정보 제공:
           - 퍼센트와 함께 텍스트 설명
           - 예: "파일 다운로드 중... 50%"
        
        4. 취소 옵션:
           <StackPanel>
               <ProgressBar Name="cancelableProgress" Height="20"/>
               <Button Content="취소" Click="Cancel_Click"/>
           </StackPanel>
        
        5. 예상 시간 표시:
           <StackPanel>
               <ProgressBar Name="timeProgress" Height="20"/>
               <TextBlock Text="예상 남은 시간: 2분 30초"/>
           </StackPanel>
        
        성능 고려사항:
        - UI 스레드에서 Value 업데이트
        - 너무 빈번한 업데이트 피하기
        - 백그라운드 작업은 Task 사용
        - IProgress<T>로 진행 보고
        
        접근성:
        - AutomationProperties로 스크린 리더 지원
        - 텍스트 진행률 함께 제공
        
        예:
        <ProgressBar AutomationProperties.Name="다운로드 진행률"/>
    -->
</Window>
