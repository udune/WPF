<!-- 
    ch32 스타일 - MainWindow.xaml
    Dictionary1.xaml에 정의된 전역 스타일을 사용하는 메인 윈도우입니다.
    StaticResource로 "버튼스타일"을 참조하여 버튼에 적용합니다.
    
    핵심 개념:
    - StaticResource: 리소스 참조 (정적)
    - Window.Resources: 윈도우 수준 리소스 (주석 처리됨)
    - 전역 리소스 사용: App.xaml의 MergedDictionaries
-->
<Window x:Class="ch32_스타일.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ch32_스타일"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">
    
    <!--<Window.Resources>
        <Style TargetType="Button" x:Key="버튼스타일">
            <Setter Property="Cursor" Value="Hand"></Setter>
            <Setter Property="Background" Value="Salmon"></Setter>
            <Setter Property="Foreground" Value="White"></Setter>
            <Setter Property="Width" Value="150"></Setter>
            <Setter Property="Height" Value="50"></Setter>
            <Setter Property="FontSize" Value="20"></Setter>
            <Setter Property="FontWeight" Value="Bold"></Setter>
            <Setter Property="Margin" Value="10"></Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="20"
                                Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center">
                                
                            </ContentPresenter>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>-->
    <!-- 
        Window.Resources (주석 처리됨):
        - 원래 이 윈도우에만 적용되던 로컬 스타일
        - Dictionary1.xaml로 이동하여 전역 리소스로 변경
        
        주석 처리 이유:
        - 리소스 중앙 관리
        - 여러 윈도우에서 재사용
        - App.xaml의 MergedDictionaries로 병합
        
        로컬 리소스 vs 전역 리소스:
        
        로컬 리소스 (Window.Resources):
        - 장점:
          - 빠른 프로토타이핑
          - 해당 윈도우에만 영향
          - 간단한 구조
        - 단점:
          - 재사용 불가
          - 코드 중복
          - 유지보수 어려움
        
        전역 리소스 (App.xaml):
        - 장점:
          - 재사용 가능
          - 중앙 관리
          - 일관성 유지
          - 유지보수 용이
        - 단점:
          - 초기 설정 복잡
          - 범위 관리 필요
        
        리소스 조회 순서:
        1. 현재 컨트롤의 Resources
        2. 부모 컨트롤의 Resources
        3. Window.Resources (이 파일, 주석 처리됨)
        4. Application.Resources (App.xaml)
           - MergedDictionaries (Dictionary1.xaml) ✓
        5. 시스템 리소스
        
        이 예제:
        - Window.Resources 주석 처리
        - App.xaml에서 Dictionary1.xaml 병합
        - 전역 리소스로 "버튼스타일" 사용
        
        재활성화하려면:
        - 주석 제거
        - Window.Resources의 스타일이 우선 적용
        - Dictionary1.xaml의 스타일 무시
    -->
    
    <Grid>
        <!-- 
            Grid:
            - 간단한 레이아웃
            - 버튼 하나만 포함
        -->
        
        <Button Style="{StaticResource 버튼스타일}">버튼</Button>
        <!-- 
            Button:
            - Dictionary1.xaml의 "버튼스타일" 적용
            
            Style="{StaticResource 버튼스타일}":
            - StaticResource 마크업 확장
            - "버튼스타일" 키로 리소스 검색
            - 컴파일 타임에 해결
            
            StaticResource:
            - 정적 리소스 참조
            - XAML 로드 시 한 번만 해결
            - 리소스 변경 시 UI 자동 업데이트 안 됨
            
            리소스 조회 과정:
            1. Button의 Resources 검색 (없음)
            2. Grid의 Resources 검색 (없음)
            3. Window.Resources 검색 (주석 처리, 없음)
            4. Application.Resources 검색
               - MergedDictionaries 확인
               - Dictionary1.xaml에서 "버튼스타일" 발견 ✓
            5. 스타일 적용
            
            적용된 속성:
            - Cursor: Hand (손 모양)
            - Background: Salmon (연어색)
            - Foreground: White (흰색 텍스트)
            - Width: 150px
            - Height: 50px
            - FontSize: 20px
            - FontWeight: Bold
            - Margin: 10px (모든 방향)
            - Template: 둥근 모서리 (CornerRadius=20)
            
            Content="버튼":
            - 버튼에 표시될 텍스트
            - ContentPresenter가 렌더링
            
            결과:
            ┌─────────────────┐
            │   버튼          │ ← Salmon 배경, 흰색 텍스트
            └─────────────────┘
               둥근 모서리 (CornerRadius=20)
            
            StaticResource vs DynamicResource:
            
            StaticResource:
            - 컴파일 타임 해결
            - 빠름
            - 리소스 변경 시 자동 업데이트 안 됨
            - 대부분의 경우 사용
            
            예:
            <Button Style="{StaticResource 버튼스타일}"/>
            
            DynamicResource:
            - 런타임 해결
            - 느림
            - 리소스 변경 시 자동 업데이트
            - 테마 전환 등에 사용
            
            예:
            <Button Style="{DynamicResource 버튼스타일}"/>
            
            리소스 변경:
            Application.Current.Resources["버튼스타일"] = newStyle;
            → StaticResource: 변경 안 됨
            → DynamicResource: 자동 업데이트
            
            스타일 미적용 (기본):
            <Button>버튼</Button>
            - 기본 버튼 스타일
            - 사각형, 회색 배경
            
            스타일 적용:
            <Button Style="{StaticResource 버튼스타일}">버튼</Button>
            - 사용자 정의 스타일
            - 둥근 모서리, Salmon 배경
            
            로컬에서 속성 재정의:
            <Button Style="{StaticResource 버튼스타일}" Background="Blue">버튼</Button>
            - 로컬 속성이 스타일보다 우선
            - Background: Blue (Salmon 대신)
            - 다른 속성은 스타일 적용
            
            스타일 없이 직접 설정:
            <Button Cursor="Hand" Background="Salmon" Foreground="White"
                    Width="150" Height="50" FontSize="20" FontWeight="Bold"
                    Margin="10">버튼</Button>
            - 스타일 없이 모든 속성 직접 설정
            - Template은 설정 불가 (XAML에서 복잡)
            - 코드 중복, 유지보수 어려움
        -->
    </Grid>
    
    <!--
        스타일 사용 패턴:
        
        ========== 1. 기본 사용 ==========
        
        <Button Style="{StaticResource 버튼스타일}">버튼</Button>
        
        ========== 2. 로컬 속성 재정의 ==========
        
        <Button Style="{StaticResource 버튼스타일}" 
                Background="Blue" 
                Width="200">
            버튼
        </Button>
        
        적용 순서:
        1. 스타일 적용 (Salmon, Width=150)
        2. 로컬 속성 재정의 (Blue, Width=200)
        
        결과:
        - Background: Blue (재정의됨)
        - Width: 200 (재정의됨)
        - 나머지: 스타일 적용
        
        ========== 3. 여러 버튼에 적용 ==========
        
        <StackPanel>
            <Button Style="{StaticResource 버튼스타일}">버튼1</Button>
            <Button Style="{StaticResource 버튼스타일}">버튼2</Button>
            <Button Style="{StaticResource 버튼스타일}">버튼3</Button>
        </StackPanel>
        
        모든 버튼이 동일한 스타일:
        - 일관성 유지
        - 한 곳에서 수정
        
        ========== 4. 다른 스타일 사용 ==========
        
        <StackPanel>
            <Button Style="{StaticResource 버튼스타일}">Salmon</Button>
            <Button Style="{StaticResource 버튼스타일2}">LightGreen</Button>
        </StackPanel>
        
        ========== 5. 조건부 스타일 적용 ==========
        
        코드:
        private void ApplyStyle(bool condition)
        {
            if (condition)
                myButton.Style = (Style)Resources["버튼스타일"];
            else
                myButton.Style = (Style)Resources["버튼스타일2"];
        }
        
        ========== 6. Trigger로 동적 변경 ==========
        
        <Button Style="{StaticResource 버튼스타일}">
            <Button.Triggers>
                <EventTrigger RoutedEvent="MouseEnter">
                    <BeginStoryboard>
                        <Storyboard>
                            <ColorAnimation Storyboard.TargetProperty="(Button.Background).(SolidColorBrush.Color)"
                                          To="Red" Duration="0:0:0.3"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Button.Triggers>
        </Button>
        
        ========== 7. 데이터 바인딩과 함께 사용 ==========
        
        <ItemsControl ItemsSource="{Binding Items}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Button Style="{StaticResource 버튼스타일}" 
                            Content="{Binding Name}"/>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
        
        ========== 8. 암시적 스타일 (x:Key 없음) ==========
        
        Dictionary1.xaml:
        <Style TargetType="Button">
            <!-- x:Key 없음 -->
            <Setter Property="Background" Value="Salmon"/>
        </Style>
        
        MainWindow.xaml:
        <Button>버튼</Button>
        <!-- Style 지정 안 해도 자동 적용 -->
        
        장점:
        - Style 지정 생략
        - 모든 Button에 자동 적용
        
        단점:
        - 선택적 적용 불가
        - 기본 스타일 원할 때 불편
        
        ========== 9. 리소스 존재 확인 ==========
        
        코드:
        if (Resources.Contains("버튼스타일"))
        {
            var style = (Style)Resources["버튼스타일"];
            myButton.Style = style;
        }
        
        ========== 10. 런타임 스타일 변경 ==========
        
        private void ChangeTheme()
        {
            var dict = new ResourceDictionary
            {
                Source = new Uri("Dictionary2.xaml", UriKind.Relative)
            };
            
            Application.Current.Resources.MergedDictionaries.Clear();
            Application.Current.Resources.MergedDictionaries.Add(dict);
        }
        
        ========== 주의사항 ==========
        
        1. StaticResource vs DynamicResource:
           - 대부분 StaticResource 사용
           - 테마 전환은 DynamicResource
        
        2. 리소스 키:
           - 대소문자 구분
           - "버튼스타일" ≠ "버튼스타일"
        
        3. 로컬 속성 우선:
           - Style의 속성보다 로컬 속성이 우선
        
        4. Template 재정의:
           - Template은 로컬에서 재정의 어려움
           - 새 스타일 만들기 권장
        
        5. 성능:
           - StaticResource가 DynamicResource보다 빠름
           - 변경이 잦지 않으면 StaticResource
    -->
</Window>
