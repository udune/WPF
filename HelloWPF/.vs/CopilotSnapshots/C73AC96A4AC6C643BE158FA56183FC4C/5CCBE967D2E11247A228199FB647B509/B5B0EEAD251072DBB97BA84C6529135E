<!-- 
    UserControl1.xaml - 전역 스타일을 사용하는 UserControl
    Dictionary1.xaml에 정의된 "버튼스타일"을 사용합니다.
    
    핵심 개념:
    - UserControl: 재사용 가능한 컨트롤
    - 전역 리소스 사용: App.xaml의 MergedDictionaries
    - UserControl.Resources: 컨트롤 수준 리소스 (주석 처리됨)
-->
<UserControl x:Class="ch32_스타일.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ch32_스타일"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <!-- 
        UserControl:
        - 재사용 가능한 사용자 정의 컨트롤
        - Window, Page에 배치 가능
        
        d:DesignHeight, d:DesignWidth:
        - 디자인 타임 크기
        - 디자이너에서 미리보기
        - 런타임에는 부모 컨트롤에 맞춤
    -->
    
    <!--<UserControl.Resources>
        <Style TargetType="Button" x:Key="버튼스타일">
            <Setter Property="Cursor" Value="Hand"></Setter>
            <Setter Property="Background" Value="Salmon"></Setter>
            <Setter Property="Foreground" Value="White"></Setter>
            <Setter Property="Width" Value="150"></Setter>
            <Setter Property="Height" Value="50"></Setter>
            <Setter Property="FontSize" Value="20"></Setter>
            <Setter Property="FontWeight" Value="Bold"></Setter>
            <Setter Property="Margin" Value="10"></Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border CornerRadius="20"
                            Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center">

                            </ContentPresenter>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>-->
    <!-- 
        UserControl.Resources (주석 처리됨):
        - 원래 이 UserControl에만 적용되던 로컬 스타일
        - Dictionary1.xaml로 이동하여 전역 리소스로 변경
        
        주석 처리 이유:
        - MainWindow.xaml과 동일한 이유
        - 리소스 중앙 관리
        - 여러 곳에서 재사용
        - App.xaml의 MergedDictionaries로 병합
        
        로컬 리소스 vs 전역 리소스:
        
        로컬 리소스 (UserControl.Resources):
        - 장점:
          - UserControl에만 영향
          - 캡슐화 (외부 영향 없음)
          - 독립적인 스타일
        - 단점:
          - 재사용 불가
          - 다른 UserControl과 중복
          - 일관성 유지 어려움
        
        전역 리소스 (App.xaml):
        - 장점:
          - 모든 곳에서 재사용
          - 일관성 유지
          - 중앙 관리
        - 단점:
          - 전역 네임스페이스 오염
          - 키 충돌 가능성
        
        리소스 조회 순서:
        1. Button의 Resources
        2. Grid의 Resources
        3. UserControl.Resources (주석 처리, 없음)
        4. 부모 컨트롤의 Resources
        5. Window/Page.Resources
        6. Application.Resources
           - MergedDictionaries (Dictionary1.xaml) ✓
        7. 시스템 리소스
        
        UserControl의 리소스 전략:
        
        1. 완전히 독립적인 UserControl:
           - UserControl.Resources에 정의
           - 외부 의존 없음
           - 재사용 시 항상 동일한 스타일
        
        2. 테마를 따르는 UserControl:
           - 전역 리소스 사용 (현재 방법)
           - 애플리케이션 테마와 일관성
           - 테마 전환 시 자동 업데이트 (DynamicResource)
        
        3. 하이브리드:
           - 기본 스타일은 UserControl.Resources
           - 테마별 색상은 전역 리소스 참조
           
           예:
           <UserControl.Resources>
               <Style TargetType="Button" x:Key="MyButton">
                   <Setter Property="Background" Value="{DynamicResource PrimaryBrush}"/>
                   <Setter Property="Width" Value="150"/>
               </Style>
           </UserControl.Resources>
    -->
    
    <Grid>
        <!-- 
            Grid:
            - 간단한 레이아웃
            - 버튼 하나만 포함
        -->
        
        <Button Style="{StaticResource 버튼스타일}">버튼</Button>
        <!-- 
            Button:
            - Dictionary1.xaml의 "버튼스타일" 적용
            
            Style="{StaticResource 버튼스타일}":
            - StaticResource 마크업 확장
            - "버튼스타일" 키로 리소스 검색
            
            리소스 조회 과정:
            1. Button의 Resources 검색 (없음)
            2. Grid의 Resources 검색 (없음)
            3. UserControl.Resources 검색 (주석 처리, 없음)
            4. 부모 컨트롤의 Resources 검색
               (UserControl이 배치된 Window/Page)
            5. Application.Resources 검색
               - MergedDictionaries 확인
               - Dictionary1.xaml에서 "버튼스타일" 발견 ✓
            6. 스타일 적용
            
            버튼스타일 적용 속성:
            - Cursor: Hand
            - Background: Salmon (연어색)
            - Foreground: White
            - Width: 150px
            - Height: 50px
            - FontSize: 20px
            - FontWeight: Bold
            - Margin: 10px
            - Template: 둥근 모서리 (CornerRadius=20)
            
            MainWindow.xaml과 동일한 스타일:
            - MainWindow: "버튼스타일" (Salmon)
            - UserControl1: "버튼스타일" (Salmon)
            - Page1: "버튼스타일2" (LightGreen)
            
            일관성:
            - 모든 곳에서 동일한 스타일
            - App.xaml의 MergedDictionaries
            - 중앙 관리
            
            Content="버튼":
            - 버튼에 표시될 텍스트
            
            UserControl 사용:
            MainWindow.xaml:
            <local:UserControl1/>
            
            결과:
            - UserControl1이 표시됨
            - 버튼 스타일 적용됨
            - 전역 리소스 활용
        -->
    </Grid>
    
    <!--
        UserControl에서 스타일 사용:
        
        ========== 1. 전역 스타일 사용 (현재 방법) ==========
        
        <Button Style="{StaticResource 버튼스타일}">버튼</Button>
        
        장점:
        - 애플리케이션 전체와 일관성
        - 테마 변경 시 자동 적용
        
        단점:
        - 전역 리소스에 의존
        - 독립성 낮음
        
        ========== 2. 로컬 스타일 사용 ==========
        
        <UserControl.Resources>
            <Style TargetType="Button" x:Key="LocalButton">
                <Setter Property="Background" Value="Blue"/>
            </Style>
        </UserControl.Resources>
        
        <Grid>
            <Button Style="{StaticResource LocalButton}">버튼</Button>
        </Grid>
        
        장점:
        - UserControl 독립성
        - 캡슐화
        - 외부 의존 없음
        
        단점:
        - 재사용 시 스타일 중복
        - 전역 테마와 불일치 가능
        
        ========== 3. 하이브리드 (권장) ==========
        
        <UserControl.Resources>
            <Style TargetType="Button" x:Key="MyButton" 
                   BasedOn="{StaticResource 버튼스타일}">
                <Setter Property="Margin" Value="5"/>
            </Style>
        </UserControl.Resources>
        
        <Grid>
            <Button Style="{StaticResource MyButton}">버튼</Button>
        </Grid>
        
        장점:
        - 전역 스타일 상속
        - UserControl별 커스터마이징
        - 일관성 + 유연성
        
        ========== 4. DynamicResource로 테마 지원 ==========
        
        <Button Style="{DynamicResource 버튼스타일}">버튼</Button>
        
        테마 전환:
        Application.Current.Resources.MergedDictionaries.Clear();
        Application.Current.Resources.MergedDictionaries.Add(darkTheme);
        
        결과:
        - UserControl의 버튼도 자동 업데이트
        
        ========== 5. 속성으로 스타일 선택 ==========
        
        UserControl1.xaml.cs:
        public string ButtonStyleKey { get; set; } = "버튼스타일";
        
        UserControl1.xaml:
        <Button Style="{DynamicResource {Binding ButtonStyleKey}}">버튼</Button>
        
        사용:
        <local:UserControl1 ButtonStyleKey="버튼스타일2"/>
        
        ========== 6. 여러 버튼에 다른 스타일 ==========
        
        <StackPanel>
            <Button Style="{StaticResource 버튼스타일}">Salmon</Button>
            <Button Style="{StaticResource 버튼스타일2}">LightGreen</Button>
        </StackPanel>
        
        ========== 7. UserControl 재사용 ==========
        
        MainWindow.xaml:
        <StackPanel>
            <local:UserControl1/>
            <local:UserControl1/>
            <local:UserControl1/>
        </StackPanel>
        
        결과:
        - 3개의 UserControl1
        - 모두 동일한 버튼 스타일
        - 전역 리소스 활용
        
        ========== 8. UserControl에서 스타일 재정의 ==========
        
        MainWindow.xaml:
        <local:UserControl1>
            <local:UserControl1.Resources>
                <Style TargetType="Button" x:Key="버튼스타일">
                    <Setter Property="Background" Value="Red"/>
                </Style>
            </local:UserControl1.Resources>
        </local:UserControl1>
        
        결과:
        - 이 UserControl1만 Red 배경
        - 다른 UserControl1은 Salmon
        
        ========== 9. 라이브러리로 배포 ==========
        
        UserControl을 별도 DLL로 배포:
        - 자체 ResourceDictionary 포함
        - 독립적인 스타일
        
        Generic.xaml:
        <Style TargetType="local:UserControl1">
            <Setter Property="Template">
                ...
            </Setter>
        </Style>
        
        ========== 10. 디자인 타임 리소스 ==========
        
        <UserControl d:DataContext="{d:DesignInstance Type=local:ViewModel}">
            <UserControl.Resources>
                <Style TargetType="Button" x:Key="DesignButton">
                    <!-- 디자인 타임 전용 -->
                </Style>
            </UserControl.Resources>
        </UserControl>
        
        ========== UserControl 스타일 전략 ==========
        
        독립적인 라이브러리:
        - 자체 Resources 사용
        - 외부 의존 최소화
        
        애플리케이션 컴포넌트:
        - 전역 리소스 활용 (현재)
        - 테마 일관성
        
        하이브리드:
        - 기본은 전역 리소스
        - 필요 시 로컬 재정의
        
        ========== 주의사항 ==========
        
        1. 리소스 조회:
           - UserControl → 부모 → Application
           - 조회 범위 이해 필요
        
        2. 캡슐화:
           - 완전히 독립적인 UserControl
           - 자체 Resources 권장
        
        3. 일관성:
           - 애플리케이션 컴포넌트
           - 전역 리소스 활용
        
        4. 테마:
           - DynamicResource 사용
           - 런타임 변경 지원
        
        5. 성능:
           - StaticResource가 빠름
           - 변경 없으면 Static 사용
    -->
</UserControl>
