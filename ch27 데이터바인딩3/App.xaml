<!-- 
    App.xaml - 데이터바인딩3 학습 애플리케이션의 진입점
    WPF 애플리케이션의 전역 설정 및 리소스를 정의합니다.
-->
<Application x:Class="ch27_데이터바인딩3.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:ch27_데이터바인딩3"
             StartupUri="MainWindow.xaml">
    <!-- 
        Application 속성 설명:
        
        x:Class: 코드 비하인드 파일(App.xaml.cs)과 연결
        StartupUri: 애플리케이션 시작 시 표시될 윈도우 지정
        xmlns:local: 현재 프로젝트의 네임스페이스 참조
    -->
    
    <!-- 
        Application.Resources: 애플리케이션 전역 리소스 정의 영역
        
        ListBox와 ListView 관련 전역 리소스 예제:
        <Application.Resources>
            ========== DataTemplate (ItemTemplate) ==========
            
            Person DataTemplate:
            <DataTemplate x:Key="PersonItemTemplate" DataType="{x:Type local:Person}">
                <Border BorderBrush="Gray" BorderThickness="1" Padding="5" Margin="2">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="{Binding 이름}" 
                                  FontSize="14" FontWeight="Bold" Margin="0,0,10,0"/>
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="{Binding 나이, StringFormat=나이: {0}세}" 
                                      Foreground="Gray"/>
                            <ProgressBar Value="{Binding 별점}" Height="10" Margin="0,2,0,0"/>
                        </StackPanel>
                        <TextBlock Grid.Column="2" Text="{Binding 별점, StringFormat={}{0}점}" 
                                  FontSize="12" VerticalAlignment="Center"/>
                    </Grid>
                </Border>
            </DataTemplate>
            
            사용:
            <ListBox ItemsSource="{Binding People}" 
                    ItemTemplate="{StaticResource PersonItemTemplate}"/>
            
            Card Style DataTemplate:
            <DataTemplate x:Key="PersonCardTemplate">
                <Border Background="LightBlue" CornerRadius="5" Padding="10" Margin="5">
                    <StackPanel>
                        <TextBlock Text="{Binding 이름}" FontSize="16" FontWeight="Bold"/>
                        <TextBlock Text="{Binding 나이, StringFormat=나이: {0}세}" Foreground="Gray"/>
                        <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                            <TextBlock Text="별점: " FontWeight="Bold"/>
                            <ProgressBar Value="{Binding 별점}" Width="100" Height="15"/>
                            <TextBlock Text="{Binding 별점}" Margin="5,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </DataTemplate>
            
            Horizontal DataTemplate:
            <DataTemplate x:Key="PersonHorizontalTemplate">
                <StackPanel Orientation="Horizontal" Margin="5">
                    <TextBlock Text="{Binding 이름}" Width="80" FontWeight="Bold"/>
                    <TextBlock Text="{Binding 나이}" Width="40" Foreground="Gray"/>
                    <ProgressBar Value="{Binding 별점}" Width="100" Height="20"/>
                    <TextBlock Text="{Binding 별점, StringFormat={}{0}점}" Margin="5,0,0,0"/>
                </StackPanel>
            </DataTemplate>
            
            ========== Style (ListBox, ListView) ==========
            
            ListBox Style:
            <Style x:Key="CustomListBoxStyle" TargetType="ListBox">
                <Setter Property="BorderBrush" Value="Gray"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="5"/>
                <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
                <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
            </Style>
            
            ListBoxItem Style:
            <Style x:Key="CustomListBoxItemStyle" TargetType="ListBoxItem">
                <Setter Property="Padding" Value="5"/>
                <Setter Property="Margin" Value="2"/>
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="LightBlue"/>
                        <Setter Property="Foreground" Value="Black"/>
                    </Trigger>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="LightGray"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            
            사용:
            <ListBox Style="{StaticResource CustomListBoxStyle}"
                    ItemContainerStyle="{StaticResource CustomListBoxItemStyle}"/>
            
            ListView Style:
            <Style x:Key="CustomListViewStyle" TargetType="ListView">
                <Setter Property="BorderBrush" Value="DarkGray"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="GridViewColumnHeader.FontWeight" Value="Bold"/>
                <Setter Property="GridViewColumnHeader.Background" Value="LightGray"/>
            </Style>
            
            GridViewColumnHeader Style:
            <Style x:Key="CustomHeaderStyle" TargetType="GridViewColumnHeader">
                <Setter Property="Background" Value="SteelBlue"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Padding" Value="5"/>
                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="DarkBlue"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            
            사용:
            <ListView.View>
                <GridView ColumnHeaderContainerStyle="{StaticResource CustomHeaderStyle}">
                    ...
                </GridView>
            </ListView.View>
            
            ========== Converter (값 변환) ==========
            
            Score to Color Converter:
            <local:ScoreToColorConverter x:Key="ScoreToColorConverter"/>
            
            구현:
            public class ScoreToColorConverter : IValueConverter
            {
                public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
                {
                    if (value is int score)
                    {
                        return score >= 90 ? Brushes.Green :
                               score >= 80 ? Brushes.Blue :
                               score >= 70 ? Brushes.Orange :
                               Brushes.Red;
                    }
                    return Brushes.Black;
                }
                
                public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
                {
                    throw new NotImplementedException();
                }
            }
            
            사용:
            <ProgressBar Value="{Binding 별점}" 
                        Foreground="{Binding 별점, Converter={StaticResource ScoreToColorConverter}}"/>
            
            Age Group Converter:
            <local:AgeGroupConverter x:Key="AgeGroupConverter"/>
            
            구현:
            public class AgeGroupConverter : IValueConverter
            {
                public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
                {
                    if (value is int age)
                    {
                        return age < 10 ? "어린이" :
                               age < 20 ? "청소년" :
                               age < 60 ? "성인" :
                               "노인";
                    }
                    return "알 수 없음";
                }
            }
            
            사용:
            <TextBlock Text="{Binding 나이, Converter={StaticResource AgeGroupConverter}}"/>
            
            ========== 실전 활용 예제 ==========
            
            1. 검색 가능한 목록:
            <Application.Resources>
                <DataTemplate x:Key="SearchableItemTemplate">
                    <Border BorderBrush="Gray" BorderThickness="0,0,0,1" Padding="5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <TextBlock Text="{Binding 이름}" FontWeight="Bold"/>
                                <TextBlock Text="{Binding 나이, StringFormat=나이: {0}세}" 
                                          Foreground="Gray" FontSize="10"/>
                            </StackPanel>
                            <ProgressBar Grid.Column="1" Value="{Binding 별점}" 
                                        Width="80" Height="20" Margin="10,0,0,0"/>
                        </Grid>
                    </Border>
                </DataTemplate>
            </Application.Resources>
            
            Window:
            <StackPanel>
                <TextBox x:Name="searchBox" TextChanged="Search" Margin="5"/>
                <ListBox ItemsSource="{Binding FilteredPeople}" 
                        ItemTemplate="{StaticResource SearchableItemTemplate}"/>
            </StackPanel>
            
            2. 마스터-디테일 패턴:
            <Application.Resources>
                <DataTemplate x:Key="MasterItemTemplate">
                    <TextBlock Text="{Binding 이름}" Padding="5"/>
                </DataTemplate>
                
                <DataTemplate x:Key="DetailTemplate">
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="10">
                        <StackPanel>
                            <TextBlock Text="{Binding 이름}" FontSize="20" FontWeight="Bold"/>
                            <TextBlock Text="{Binding 나이, StringFormat=나이: {0}세}" 
                                      FontSize="14" Margin="0,5,0,0"/>
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <TextBlock Text="별점: " FontWeight="Bold" VerticalAlignment="Center"/>
                                <ProgressBar Value="{Binding 별점}" Width="200" Height="25"/>
                                <TextBlock Text="{Binding 별점, StringFormat={}{0}점}" 
                                          Margin="10,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </Application.Resources>
            
            Window:
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <ListBox ItemsSource="{Binding People}" 
                        SelectedItem="{Binding SelectedPerson, Mode=TwoWay}"
                        ItemTemplate="{StaticResource MasterItemTemplate}"/>
                <ContentControl Grid.Column="1" 
                               Content="{Binding SelectedPerson}"
                               ContentTemplate="{StaticResource DetailTemplate}"/>
            </Grid>
            
            3. 그룹화된 ListView:
            <Application.Resources>
                <GroupStyle x:Key="PersonGroupStyle">
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <Border Background="SteelBlue" Padding="5">
                                <TextBlock Text="{Binding Name}" 
                                          Foreground="White" FontWeight="Bold"/>
                            </Border>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                </GroupStyle>
            </Application.Resources>
            
            Window:
            <ListView GroupStyle="{StaticResource PersonGroupStyle}"/>
            
            코드:
            var view = CollectionViewSource.GetDefaultView(lv.ItemsSource);
            view.GroupDescriptions.Add(new PropertyGroupDescription("나이범위"));
            
            4. 편집 가능한 ListView:
            <Application.Resources>
                <DataTemplate x:Key="EditableCellTemplate">
                    <TextBox Text="{Binding 이름, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                            BorderThickness="0"/>
                </DataTemplate>
            </Application.Resources>
            
            ListView:
            <GridViewColumn Header="이름" CellTemplate="{StaticResource EditableCellTemplate}"/>
            
            5. 아이콘 포함 ItemTemplate:
            <Application.Resources>
                <DataTemplate x:Key="IconItemTemplate">
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{Binding IconPath}" Width="32" Height="32" Margin="0,0,10,0"/>
                        <StackPanel>
                            <TextBlock Text="{Binding 이름}" FontWeight="Bold"/>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="나이: " Foreground="Gray" FontSize="10"/>
                                <TextBlock Text="{Binding 나이}" Foreground="Gray" FontSize="10"/>
                                <TextBlock Text="세" Foreground="Gray" FontSize="10" Margin="2,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </Application.Resources>
            
            ========== 성능 최적화 ==========
            
            VirtualizingStackPanel Style:
            <Style x:Key="VirtualizedListBoxStyle" TargetType="ListBox">
                <Setter Property="VirtualizingPanel.IsVirtualizing" Value="True"/>
                <Setter Property="VirtualizingPanel.VirtualizationMode" Value="Recycling"/>
                <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
            </Style>
            
            사용:
            <ListBox Style="{StaticResource VirtualizedListBoxStyle}"/>
            
            장점:
            - 보이는 항목만 렌더링
            - 대량 데이터 처리 가능
            - 메모리 사용량 감소
            
            ========== 주의사항 ==========
            
            1. DataTemplate 재사용:
               - Resources에 정의
               - 여러 ListBox/ListView에서 공유
            
            2. Style 일관성:
               - 애플리케이션 전체에 동일한 스타일
               - 유지보수 용이
            
            3. Converter 성능:
               - 자주 호출됨
               - 가벼운 연산만
            
            4. 가상화:
               - 대량 데이터 시 필수
               - VirtualizingStackPanel 활용
        </Application.Resources>
    -->
    <Application.Resources>
         <!-- 현재 비어 있음 - 필요시 전역 DataTemplate, Style, Converter 추가 -->
    </Application.Resources>
</Application>
